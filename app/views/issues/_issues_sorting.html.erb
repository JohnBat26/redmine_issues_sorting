<script type="text/javascript">
    window.I18n = <%= current_translations.to_json.html_safe %>

            $('#issue_tree p strong:contains(' + I18n.label_subtask_plural + ')').append(' (' + I18n.label_сounts_tasks + ' '
            + $('#issue_tree .issue.hascontextmenu').length +
            ', ' + I18n.label_from + ' ' + I18n.label_tasks_new + ': ' + $('#issue_tree .issue.hascontextmenu > td:contains("New")').length +
            ', ' + I18n.label_tasks_in_progress + ': ' + $('#issue_tree .issue.hascontextmenu > td:contains("In Progress")').length +
            ', ' + I18n.label_tasks_resolved + ': ' + $('#issue_tree .issue.hascontextmenu > td:contains("Resolved")').length +
            ', ' + I18n.label_tasks_сlosed + ': ' + $('#issue_tree .issue.hascontextmenu > td:contains("Closed")').length +
            ', ' + I18n.label_tasks_reopened + ': ' + $('#issue_tree .issue.hascontextmenu > td:contains("Reopened")').length +
             ')');

    $('#issue_tree table.list.issues').attr('id', 'subTaskTable').addClass('tablesorter');
    $('#relations table.list.issues').attr('id', 'relationsTaskTable').addClass('tablesorter');

    var queryString = '.controller-issues.action-show #content table:has(th):not(.attributes)';

    $(queryString).prepend('<thead></thead>');
    $(queryString).each(function () {
        $(this).find('thead').wrapInner($(this).find('tbody tr:first-child'));
    });
    $('#subTaskTable tbody').first().before('<thead>' +
    '<th style="display:none">111</th>' +
    '<th>' + I18n.field_name + '</th>' +
    '<th>' + I18n.field_status + '</th>' +
    '<th>' + I18n.field_assigned_to + '</th>' +
    '<th>' + I18n.field_start_date + '</th>' +
    '<th>' + I18n.field_due_date + '</th>' +
    '<th style="display:none">progress</th>' +
    '</thead>');
    $('#subTaskTable').tablesorter();

    $('#relationsTaskTable tbody').first().before('<thead>' +
    '<th style="display:none">111</th>' +
    '<th>' + I18n.field_name + '</th>' +
    '<th>' + I18n.field_status + '</th>' +
    '<th>' + I18n.field_assigned_to + '</th>' +
    '<th>' + I18n.field_start_date + '</th>' +
    '<th>' + I18n.field_due_date + '</th>' +
    '<th style="display:none">progress</th>' +
    '</thead>');
    $('#relationsTaskTable').tablesorter();

    $('.controller-repositories.action-show table#browser').tablesorter();
    $(queryString).each(function () {
        $(this).tablesorter();
    });
    $('.controller-issues.action-show th.header').css('cursor', 'pointer');
    $('.controller-repositories.action-show table#browser th.header').css('cursor', 'pointer');
</script>